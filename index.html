<!DOCTYPE html>
<html lang="th">

<head>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#FDFBF7">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <link rel="preconnect" href="https://static.line-scdn.net">
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <script>
        window.tailwind = {
            config: {
                theme: {
                    extend: {
                        colors: {
                            brand: {
                                primary: '#FF6B00',
                                accent: '#22C55E',
                                text: '#111827',
                                orange: '#FF6B00',
                                green: '#22C55E'
                            }
                        },
                        fontFamily: {
                            sans: ['Sarabun', 'sans-serif'],
                            heading: ['Kanit', 'sans-serif'],
                            round: ['Kanit', 'sans-serif']
                        },
                        borderRadius: { '4xl': '2.5rem' },
                        animation: {
                            'bounce-slow': 'bounce 3s infinite',
                            'enter-up': 'enterUp 0.6s cubic-bezier(0.19, 1, 0.22, 1) forwards',
                            'pop-in': 'popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards',
                        },
                        keyframes: {
                            enterUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                            popIn: { '0%': { opacity: '0', transform: 'scale(0.95)' }, '100%': { opacity: '1', transform: 'scale(1)' } }
                        }
                    }
                }
            }
        }
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

    <!-- Supabase Integration -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-client.js"></script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4FR74WPRNY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-4FR74WPRNY');
    </script>

    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/3448/3448609.png">
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/3448/3448609.png">
    <title>Kaprao52 - APP</title>

    <link
        href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700;800;900&family=Sarabun:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Modular CSS Styles -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/cosmic.css">
    <link rel="stylesheet" href="css/navigation.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/redesign.css">

</head>

<body class="pb-32 font-sans select-none relative overflow-x-hidden safe-area-pt">

    <!-- MINIMAL BACKGROUND (Clean) -->
    <div class="fixed inset-0 -z-10 bg-[#FDFBF7]"></div>
    <canvas id="bg-canvas" class="fixed inset-0 -z-10 pointer-events-none"></canvas>
    <canvas id="confetti-canvas" class="fixed inset-0 z-[200] pointer-events-none"></canvas>


    <!-- LOADER -->
    <div id="global-loader">
        <div class="cooking-container mb-4">
            <div class="steam-particle steam-1">üí®</div>
            <div class="steam-particle steam-2">üí®</div>
            <div class="steam-particle steam-3">üí®</div>
            <div class="absolute inset-0 bg-[#9C836E] rounded-full blur-xl opacity-20 animate-pulse"></div>
            <div class="cooking-pan text-[#5D4037]">üç≥</div>
        </div>


        <h2 class="text-2xl font-black text-[#4A403A] tracking-wider">KAPRAO<span class="text-[#9C836E]">52</span></h2>

        <p id="loader-text" class="text-sm text-gray-500 mt-2 font-medium">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡πâ‡∏≤‡∏ô...</p>
        <div class="loading-dots">
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
        </div>
    </div>

    <!-- Welcome Modal -->
    <div id="welcome-modal"
        class="fixed inset-0 z-[200] bg-black/30 backdrop-blur-sm flex items-center justify-center p-6 stagger-item">
        <div
            class="glass-heavy rounded-[2rem] p-8 max-w-sm w-full text-center shadow-2xl relative overflow-hidden border border-white/50">
            <button onclick="closeWelcome()"
                class="btn-bounce absolute top-4 right-4 z-50 w-10 h-10 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center hover:bg-gray-200 transition-all">
                <i class="fas fa-times text-sm"></i>
            </button>
            <div class="relative z-10">
                <div
                    class="w-24 h-24 bg-yellow-50 rounded-full flex items-center justify-center mx-auto mb-4 text-5xl shadow-sm border border-yellow-100 animate-bounce-slow">
                    üéüÔ∏è
                </div>
                <h2 class="text-2xl font-black text-gray-800 mb-2">‡∏•‡∏∏‡πâ‡∏ô‡∏Å‡∏¥‡∏ô‡∏ü‡∏£‡∏µ‡∏ó‡∏∏‡∏Å‡∏á‡∏ß‡∏î!</h2>
                <p class="text-gray-600 mb-4 leading-relaxed text-sm">
                    <span class="font-bold text-indigo-500 text-base">‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ ‡∏≠‡∏¢‡πà‡∏≤‡∏ó‡∏¥‡πâ‡∏á!</span><br>
                    ‡πÄ‡∏•‡∏Ç‡∏ó‡πâ‡∏≤‡∏¢ Order ID ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö<br>
                    <span
                        class="bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded font-bold border border-yellow-200">‡πÄ‡∏•‡∏Ç‡∏ó‡πâ‡∏≤‡∏¢
                        2 ‡∏ï‡∏±‡∏ß ‡∏´‡∏ß‡∏¢‡∏£‡∏±‡∏ê‡∏ö‡∏≤‡∏•</span><br>
                    ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏¥‡∏ô‡∏ü‡∏£‡∏µ‡∏°‡∏∑‡πâ‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡∏ô‡∏ó‡∏µ! üéÅ
                </p>
                <!-- NEW: Next Draw Countdown -->
                <div class="bg-gray-50 rounded-xl p-3 mb-4 border border-gray-200">
                    <p class="text-xs text-gray-500 mb-2">üéØ ‡∏á‡∏ß‡∏î‡∏´‡∏ß‡∏¢‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</p>
                    <div id="next-draw-countdown" class="countdown-timer">
                        <div class="countdown-box">
                            <div class="number" id="cd-days">--</div>
                            <div class="label">‡∏ß‡∏±‡∏ô</div>
                        </div>
                        <div class="countdown-box">
                            <div class="number" id="cd-hours">--</div>
                            <div class="label">‡∏ä‡∏°.</div>
                        </div>
                        <div class="countdown-box">
                            <div class="number" id="cd-minutes">--</div>
                            <div class="label">‡∏ô‡∏≤‡∏ó‡∏µ</div>
                        </div>
                    </div>
                    <p id="next-draw-date" class="text-xs text-indigo-600 font-bold mt-2"></p>
                </div>
                <div class="flex flex-col gap-3">
                    <!-- Option A: Login with LINE -->
                    <button onclick="loginWithLine()"
                        class="btn-bounce w-full bg-[#06C755] text-white font-bold py-3.5 rounded-xl shadow-lg transition-all text-lg hover:bg-[#05b34c] flex items-center justify-center gap-2">
                        <i class="fab fa-line text-2xl"></i> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ LINE
                    </button>

                    <!-- Option B: Guest Mode -->
                    <button onclick="loginGuest()"
                        class="btn-bounce w-full bg-gray-100 text-gray-600 font-bold py-3.5 rounded-xl shadow-sm border border-gray-200 transition-all text-base hover:bg-gray-200">
                        ‡∏™‡∏±‡πà‡∏á‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô (Guest)
                    </button>

                    <p class="text-[10px] text-gray-400 mt-2">
                        *‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∞‡∏™‡∏°‡πÅ‡∏ï‡πâ‡∏°‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Avatar Modal -->
    <div id="avatar-modal"
        class="fixed inset-0 bg-black/30 backdrop-blur-sm z-[120] hidden transition-opacity opacity-0 flex items-center justify-center p-6">
        <div
            class="glass-heavy rounded-[2rem] p-6 max-w-sm w-full shadow-2xl stagger-item border border-white/60 relative">
            <button onclick="closeAvatarModal()"
                class="btn-bounce absolute top-4 right-4 z-50 w-8 h-8 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center hover:bg-gray-200 transition-all">
                <i class="fas fa-times text-sm"></i>
            </button>
            <h3 class="text-xl font-bold text-center mb-4 text-gray-800">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß üë§</h3>
            <div class="grid grid-cols-4 gap-4 mb-6" id="avatar-grid"></div>
            <div class="mb-6">
                <label class="text-sm font-bold text-gray-600 mb-2 block pl-1">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì üí¨</label>
                <input type="text" id="pet-name-input" maxlength="12" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏û‡∏µ‡πà‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤"
                    class="w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-center font-bold text-indigo-600 focus:border-indigo-500 outline-none transition-all placeholder-gray-400">
            </div>
            <button onclick="closeAvatarModal()"
                class="btn-bounce w-full btn-gradient text-white font-bold py-3 rounded-xl shadow-lg transition-all text-lg">‡∏ï‡∏Å‡∏•‡∏á</button>
        </div>
    </div>

    <!-- NEW: Quick Order History Modal -->
    <div id="quick-order-modal"
        class="fixed inset-0 bg-black/30 backdrop-blur-sm z-[125] hidden transition-opacity opacity-0 flex items-center justify-center p-6">
        <div
            class="glass-heavy rounded-[2rem] p-6 max-w-sm w-full shadow-2xl stagger-item border border-white/60 relative max-h-[80vh] flex flex-col">
            <button onclick="closeQuickOrderModal()"
                class="btn-bounce absolute top-4 right-4 z-50 w-8 h-8 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center hover:bg-gray-200 transition-all">
                <i class="fas fa-times text-sm"></i>
            </button>
            <h3 class="text-xl font-bold text-center mb-2 text-gray-800">üìã ‡∏™‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏°</h3>
            <p class="text-xs text-gray-500 text-center mb-4">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</p>
            <div id="quick-order-list" class="flex-1 overflow-y-auto hide-scroll space-y-3">
                <div class="text-center text-gray-400 py-8">
                    <i class="fas fa-history text-3xl mb-2 opacity-30"></i>
                    <p class="text-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
                </div>
            </div>
        </div>
    </div>

    <!-- New Modern Header -->
    <div class="modern-header safe-area-pt">
        <div class="header-left">
            <img src="images/logo.png" class="header-logo"
                onerror="this.src='https://cdn-icons-png.flaticon.com/512/3448/3448609.png'" alt="Shop Logo">
            <div class="header-text">
                <h1 class="text-[#4A403A]">KAPRAO 52</h1>
                <div class="flex items-center gap-1">
                    <p id="greeting-text">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö</p>
                    <div id="vip-badge"
                        class="hidden text-[10px] bg-yellow-100 text-yellow-800 px-1 rounded border border-yellow-200">
                        VIP</div>
                </div>
            </div>
        </div>
        <div class="header-right">
            <button onclick="i18n.setLanguage(i18n.currentLang === 'th' ? 'en' : 'th')"
                class="icon-btn border border-gray-200">
                <span class="text-xs font-bold uppercase" id="lang-display">TH</span>
            </button>
            <button onclick="openPointsHistory()" class="icon-btn">
                <i class="fas fa-coins text-yellow-500"></i>
            </button>
            <div class="icon-btn" onclick="openAvatarModal()" id="header-avatar-btn">
                <img id="avatar-img" src="" class="w-full h-full rounded-full object-cover hidden" alt="Profile">
                <i class="fas fa-user text-gray-400" id="default-avatar-icon"></i>
            </div>
            <button id="line-login-btn" onclick="loginWithLine()"
                class="hidden icon-btn bg-[#06C755] text-white border-transparent w-auto px-3 rounded-full text-sm font-bold shadow-md hover:bg-[#05b34c] transition-all flex items-center gap-1">
                <i class="fab fa-line text-lg"></i>
                <span class="hidden sm:inline">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</span>
            </button>
        </div>
    </div>

    <!-- Hidden dummy ID to prevent JS errors from existing logic -->
    <div id="active-orders-btn" class="hidden"></div>

    <div id="page-home" class="view-section active pb-24">
        <!-- Hero Banner -->
        <div class="hero-banner">
            <div class="hero-content">
                <div class="hero-text">
                    <h2 class="hero-title">‡∏Å‡∏¥‡∏ô‡∏ü‡∏£‡∏µ<br>‡∏ó‡∏∏‡∏Å‡∏á‡∏ß‡∏î!</h2>
                    <p class="hero-desc">‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏•‡∏∏‡πâ‡∏ô‡∏´‡∏ß‡∏¢‡∏à‡∏≤‡∏Å Order ID</p>
                    <button onclick="openMyTickets()" class="hero-btn hover:scale-105 transition-transform">
                        <i class="fas fa-ticket-alt text-yellow-500"></i> ‡∏î‡∏π‡∏ï‡∏±‡πã‡∏ß‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô
                        <div id="unread-ticket-dot" class="w-2 h-2 bg-red-500 rounded-full hidden ml-1"></div>
                    </button>
                </div>
                <i
                    class="fas fa-ticket-alt text-white opacity-20 text-9xl absolute -right-6 -bottom-6 transform -rotate-12"></i>
            </div>
        </div>

        <!-- Activity Stats -->
        <div class="stats-row">
            <div class="stat-card" onclick="showActiveOrdersList()">
                <div class="stat-icon bg-blue-50 text-blue-500"><i class="fas fa-clipboard-list"></i></div>
                <div class="stat-info overflow-hidden">
                    <h4>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h4>
                    <p id="active-orders-count" class="text-sm truncate text-gray-400">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</p>
                </div>
            </div>
            <div class="stat-card" onclick="openPointsHistory()">
                <div class="stat-icon bg-yellow-50 text-yellow-500"><i class="fas fa-star"></i></div>
                <div class="stat-info w-full">
                    <div class="flex justify-between items-center w-full gap-2">
                        <h4>‡∏û‡∏≠‡∏¢‡∏ï‡πå‡∏™‡∏∞‡∏™‡∏°</h4>
                        <button id="refresh-points-btn" onclick="manualRefreshPoints(); event.stopPropagation();"
                            class="text-xs text-gray-300 hover:text-yellow-500"><i class="fas fa-sync-alt"></i></button>
                    </div>
                    <p id="points-count">0</p>
                </div>
            </div>
        </div>

        <div class="max-w-md mx-auto px-5 relative z-10">

            <!-- NEW: Recommended Section (Smart Suggestions) -->
            <div id="recommended-section" class="recommended-section hidden stagger-item"
                style="animation-delay: 0.05s;">
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-2">
                        <span class="text-xl">‚ú®</span>
                        <h3 class="font-bold text-gray-800 text-sm">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì</h3>
                    </div>
                    <span class="text-[10px] text-gray-500 bg-white/70 px-2 py-1 rounded-full">‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á</span>
                </div>
                <div id="recommended-items" class="flex gap-3 overflow-x-auto hide-scroll pb-1">
                    <!-- Dynamic content -->
                </div>
            </div>


            <!-- Search & Categories -->
            <div class="mb-3">
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-3">
                        <h3 class="font-bold text-gray-800 text-lg flex items-center gap-2">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h3>
                        <button onclick="toggleSearch()"
                            class="btn-bounce w-9 h-9 rounded-full bg-white border border-gray-200 shadow-sm flex items-center justify-center text-gray-500 hover:text-indigo-500 transition-colors">
                            <i class="fas fa-search text-xs"></i>
                        </button>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="scrollTabs(-100)"
                            class="btn-bounce bg-white w-9 h-9 rounded-full flex items-center justify-center text-gray-400 hover:text-indigo-500 transition-all border border-gray-200 shadow-sm"><i
                                class="fas fa-chevron-left text-xs"></i></button>
                        <button onclick="scrollTabs(100)"
                            class="btn-bounce bg-white w-9 h-9 rounded-full flex items-center justify-center text-gray-400 hover:text-indigo-500 transition-all border border-gray-200 shadow-sm"><i
                                class="fas fa-chevron-right text-xs"></i></button>
                    </div>
                </div>

                <div id="search-container" class="hidden mb-4 animate-fade-in-down">
                    <div class="relative">
                        <input type="text" id="search-input" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏°‡∏ô‡∏π (‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏°‡∏π, ‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤, ‡πÑ‡∏Ç‡πà)"
                            class="w-full bg-white border-2 border-[#E7E5E0] rounded-2xl py-3 pl-12 pr-10 text-sm font-bold text-[#3F3733] focus:border-[#B58D67] focus:ring-0 shadow-sm transition-all"
                            onkeyup="handleSearch(this.value)" autocomplete="off" aria-label="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏°‡∏ô‡∏π">

                        <div class="absolute left-4 top-3.5 text-gray-400">
                            <i class="fas fa-search"></i>
                        </div>
                        <button onclick="toggleSearch()"
                            class="absolute right-3 top-2 bg-gray-100 w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-200"
                            aria-label="‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤">
                            <i class="fas fa-times text-xs"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tab Container -->
            <div id="tabs-container"
                class="sticky top-0 z-30 pt-2 pb-4 -mx-5 px-5 flex gap-3 snap-x scroll-smooth overflow-x-auto hide-scroll transition-all">
                <button onclick="switchCategory('favorites')" id="tab-favorites"
                    class="category-pill category-pill-favorites category-pill-inactive snap-start">
                    <span class="text-xl tab-icon">‚ù§Ô∏è</span><span class="text-xs font-bold">‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö</span>
                </button>
                <button onclick="switchCategory('kaprao')" id="tab-kaprao"
                    class="category-pill category-pill-active snap-start">
                    <span class="text-xl tab-icon">üå∂Ô∏è</span><span class="text-xs">‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤</span>
                </button>
                <button onclick="switchCategory('tray')" id="tab-tray"
                    class="category-pill category-pill-inactive snap-start">
                    <span class="text-xl tab-icon">üç±</span><span class="text-xs font-bold">‡∏ä‡∏∏‡∏î‡∏ñ‡∏≤‡∏î</span>
                </button>
                <button onclick="switchCategory('garlic')" id="tab-garlic"
                    class="category-pill category-pill-inactive snap-start">
                    <span class="text-xl tab-icon">üßÑ</span><span class="text-xs">‡∏Å‡∏£‡∏∞‡πÄ‡∏ó‡∏µ‡∏¢‡∏°</span>
                </button>
                <button onclick="switchCategory('curry')" id="tab-curry"
                    class="category-pill category-pill-inactive snap-start">
                    <span class="text-xl tab-icon">ü•ò</span><span class="text-xs">‡∏û‡∏£‡∏¥‡∏Å‡πÅ‡∏Å‡∏á</span>
                </button>
                <button onclick="switchCategory('noodle')" id="tab-noodle"
                    class="category-pill category-pill-inactive snap-start">
                    <span class="text-xl tab-icon">üçú</span><span class="text-xs">‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏™‡πâ‡∏ô</span>
                </button>
                <button onclick="switchCategory('soup')" id="tab-soup"
                    class="category-pill category-pill-inactive snap-start">
                    <span class="text-xl tab-icon">üç≤</span><span class="text-xs">‡πÅ‡∏Å‡∏á/‡∏ï‡πâ‡∏°</span>
                </button>
                <button onclick="switchCategory('others')" id="tab-others"
                    class="category-pill category-pill-inactive snap-start">
                    <span class="text-xl tab-icon">üç≥</span><span class="text-xs">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</span>
                </button>
                <button onclick="switchCategory('dessert')" id="tab-dessert"
                    class="category-pill category-pill-inactive snap-start">
                    <span class="text-xl tab-icon">üç®</span><span class="text-xs">‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô</span>
                </button>
                <button onclick="switchCategory('promotion')" id="tab-promotion"
                    class="category-pill category-pill-promotion snap-start">
                    <span class="text-xl tab-icon">üßß</span><span class="text-xs font-bold">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</span>
                </button>
            </div>

            <div class="mb-4 mt-2">
                <h3 id="section-title" class="font-bold text-gray-800 text-lg">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h3>
            </div>

            <div id="dessert-msg" class="hidden mb-6 stagger-item">
                <div
                    class="bg-white border border-gray-200 rounded-xl p-4 flex flex-col items-center justify-center text-center shadow-sm">
                    <div class="text-3xl mb-2">üç® ‚ú®</div>
                    <h4 class="font-bold text-indigo-500 text-sm">‡∏£‡∏≠‡∏û‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏´‡∏°‡πà‡πÜ ‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ</h4>
                    <p class="text-xs text-gray-400 mt-1">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏±‡∏î‡∏™‡∏£‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏£‡πà‡∏≠‡∏¢‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏∏‡∏Å‡∏ó‡πà‡∏≤‡∏ô</p>
                </div>
            </div>

            <div id="menu-grid" class="grid grid-cols-2 gap-4 mb-20" role="grid" aria-label="‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£"></div>

            <div class="text-center mt-12 mb-20 opacity-50">
                <p class="text-[10px] font-bold tracking-widest text-gray-400 uppercase">DEVELOPED BY SORAWIT
                    THUNTHAKIJ
                    |
                    Version 24.2.0 COSMIC EDITION</p>
            </div>
        </div> <!-- Close max-w-md -->
    </div> <!-- Close page-home -->

    <!-- Bottom Navigation -->
    <nav class="bottom-nav safe-area-pb">
        <button class="nav-item active" onclick="scrollToTop()">
            <i class="fas fa-home"></i>
            <span>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span>
        </button>
        <button class="nav-item" onclick="showActiveOrdersList()">
            <div class="relative">
                <i class="fas fa-clipboard-list"></i>
                <div id="nav-tracking-badge"
                    class="absolute -top-1 -right-2 bg-red-500 text-white text-[9px] px-1.5 rounded-full hidden border border-white">
                    0</div>
            </div>
            <span>‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</span>
        </button>
        <button class="nav-item" onclick="openMyTickets()">
            <div class="relative">
                <i class="fas fa-ticket-alt"></i>
            </div>
            <span>‡∏ï‡∏±‡πã‡∏ß‡∏´‡∏ß‡∏¢</span>
        </button>
        <button class="nav-item" onclick="openAdminLoginModal()">
            <i class="fas fa-user-cog"></i>
            <span>‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</span>
        </button>
    </nav>

    <script>
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
    <!-- Tickets Sheet -->
    <div id="tickets-modal-overlay"
        class="fixed inset-0 bg-black/40 backdrop-blur-sm z-[110] hidden transition-opacity opacity-0"
        onclick="closeMyTickets()"></div>
    <div id="tickets-sheet"
        class="fixed bottom-0 left-0 right-0 glass-heavy rounded-t-[2.5rem] z-[111] transform translate-y-full transition-transform duration-300 shadow-2xl max-w-md mx-auto h-[80vh] flex flex-col safe-area-pb">
        <div class="w-full flex justify-center pt-4 pb-2">
            <div class="w-12 h-1.5 bg-gray-300 rounded-full"></div>
        </div>
        <div class="px-6 py-2 border-b border-gray-100 flex justify-between items-center">
            <div>
                <h2 class="text-xl font-bold text-gray-800">üé´ ‡∏ï‡∏±‡πã‡∏ß‡∏´‡∏ß‡∏¢‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h2>
                <p class="text-xs text-gray-400 mt-0.5">‡∏´‡∏ß‡∏¢‡∏≠‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡πÅ‡∏•‡∏∞ 16 ‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</p>
            </div>
            <button onclick="closeMyTickets()"
                class="btn-bounce w-10 h-10 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center hover:bg-gray-200"><i
                    class="fas fa-times text-sm"></i></button>
        </div>
        <!-- NEW: Lottery Status Header -->
        <div class="px-4 py-3 bg-gradient-to-r from-indigo-50 to-purple-50 border-b border-indigo-100">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs text-gray-500">‡∏á‡∏ß‡∏î‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</p>
                    <p id="next-lottery-date" class="text-sm font-bold text-indigo-600">--</p>
                </div>
                <div id="lottery-status-badge" class="lottery-status waiting">
                    <i class="fas fa-clock"></i>
                    <span>‡∏£‡∏≠‡∏•‡∏∏‡πâ‡∏ô</span>
                </div>
            </div>
        </div>
        <div id="tickets-list" class="flex-1 overflow-y-auto p-4 space-y-3 hide-scroll"></div>
    </div>

    <!-- Mini Cart -->
    <div id="mini-cart-bar" class="fixed left-5 right-5 z-[60] hidden stagger-item"
        style="bottom: calc(var(--bottom-nav-height, 52px) + env(safe-area-inset-bottom, 0px) + 8px);">
        <div onclick="openCheckout()"
            class="btn-bounce bg-gray-900 text-white p-4 rounded-full shadow-2xl flex justify-between items-center cursor-pointer border border-gray-800">
            <div class="flex items-center gap-3 pl-2">
                <div class="w-10 h-10 bg-yellow-500 rounded-full flex items-center justify-center text-gray-900 font-bold shadow-lg"
                    id="mini-count">0</div>
                <div class="flex flex-col">
                    <span class="text-xs text-gray-400">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</span>
                    <span class="font-bold text-lg leading-none text-indigo-300" id="mini-total">0 ‡∏ø</span>
                </div>
            </div>
            <div class="flex items-center gap-2 pr-4 text-indigo-300 font-bold text-sm">
                <span>‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</span>
                <i class="fas fa-chevron-up"></i>
            </div>
        </div>
    </div>


    <!-- Food Detail Modal -->
    <div id="food-modal" class="fixed inset-0 z-[130] bg-black/40 backdrop-blur-sm hidden transition-opacity opacity-0"
        onclick="closeModal()"></div>
    <div id="food-sheet"
        class="fixed bottom-0 w-full max-w-md mx-auto z-[131] transform translate-y-full transition-transform duration-300 bg-white rounded-t-[2.5rem] overflow-hidden shadow-2xl h-[90vh] flex flex-col">
        <div class="relative h-64 bg-gray-100 shrink-0">
            <img id="modal-img" src="" class="w-full h-full object-cover">
            <div
                class="absolute top-0 left-0 w-full h-full bg-gradient-to-b from-black/30 to-transparent pointer-events-none">
            </div>
            <button onclick="closeModal()"
                class="absolute top-4 right-4 bg-white/20 backdrop-blur-md rounded-full w-10 h-10 flex items-center justify-center text-white hover:bg-white/30 transition-all btn-bounce">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="flex-1 overflow-y-auto px-6 py-6 space-y-6 hide-scroll relative bg-white -mt-6 rounded-t-[2.5rem]">
            <div class="flex justify-between items-start">
                <div>
                    <h2 id="modal-title" class="text-2xl font-black text-gray-800 leading-tight mb-1">Title</h2>
                    <p id="modal-desc" class="text-sm text-gray-500 line-clamp-2"></p>
                </div>
                <div class="flex flex-col items-end">
                    <span id="modal-price-display" class="text-2xl font-black text-indigo-600 tracking-tight">0</span>
                    <span class="text-xs text-gray-400">‡∏ö‡∏≤‡∏ó</span>
                </div>
            </div>

            <div class="border-t border-gray-100 pt-4">
                <h3 class="font-bold text-gray-800 mb-3 flex items-center gap-2 text-sm"><i
                        class="fas fa-utensils text-yellow-500"></i> ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÄ‡∏°‡∏ô‡∏π</h3>
                <div id="modal-options" class="space-y-3">
                    <!-- Dynamic Options -->
                </div>
            </div>

            <div class="border-t border-gray-100 pt-4">
                <h3 class="font-bold text-gray-800 mb-3 flex items-center gap-2 text-sm"><i
                        class="fas fa-comment-dots text-indigo-400"></i> ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡∏£‡πâ‡∏≤‡∏ô</h3>
                <textarea id="modal-note"
                    class="w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm focus:border-indigo-500 focus:ring-0 outline-none resize-none h-20"
                    placeholder="‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏û‡∏£‡∏¥‡∏Å, ‡∏Ç‡πâ‡∏≤‡∏ß‡∏ô‡πâ‡∏≠‡∏¢, ‡πÅ‡∏¢‡∏Å‡∏ô‡πâ‡∏≥..."></textarea>
            </div>
        </div>

        <div class="p-4 bg-white border-t border-gray-100 safe-area-pb">
            <div class="flex items-center gap-4 mb-3">
                <div class="flex items-center bg-gray-100 rounded-full p-1 border border-gray-200">
                    <button onclick="adjustModalQty(-1)"
                        class="w-10 h-10 rounded-full bg-white text-gray-500 flex items-center justify-center shadow-sm hover:text-indigo-600 active:scale-90 transition-all font-bold text-lg">-</button>
                    <span id="modal-qty" class="w-12 text-center font-black text-lg text-gray-800">1</span>
                    <button onclick="adjustModalQty(1)"
                        class="w-10 h-10 rounded-full bg-white text-gray-500 flex items-center justify-center shadow-sm hover:text-indigo-600 active:scale-90 transition-all font-bold text-lg">+</button>
                </div>
            </div>
            <button onclick="addToCartFromModal()"
                class="w-full btn-bounce bg-gray-900 text-white font-bold py-4 rounded-2xl shadow-xl flex items-center justify-between px-6 hover:bg-black transition-colors">
                <span class="flex items-center gap-2"><i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</span>
                <span id="modal-total-btn" class="text-indigo-300">0 ‡∏ø</span>
            </button>
        </div>
    </div>

    <!-- Checkout Sheet -->
    <div id="checkout-overlay"
        class="fixed inset-0 bg-black/40 backdrop-blur-sm z-[150] hidden transition-opacity opacity-0"
        onclick="closeCheckout()"></div>
    <div id="checkout-sheet"
        class="fixed bottom-0 w-full h-[95vh] flex flex-col max-w-md mx-auto z-[150] transform translate-y-full transition-transform duration-300 bg-gray-50/95 backdrop-blur-xl rounded-t-[2rem] overflow-hidden shadow-2xl border-t border-white/20">
        <div class="flex-none pt-5 pb-3 px-6 bg-white border-b border-gray-100 shadow-sm relative z-20">
            <div class="w-12 h-1.5 bg-gray-200 rounded-full mx-auto mb-4"></div>
            <div class="flex justify-between items-end">
                <div>
                    <h2 class="text-2xl font-black text-gray-800 leading-none">‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h2>
                    <p class="text-xs text-gray-400 mt-1 font-medium">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡πâ‡∏≤‡∏ö</p>
                </div>
                <button onclick="closeCheckout()"
                    class="btn-bounce w-10 h-10 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center hover:bg-gray-200 transition-colors">
                    <i class="fas fa-times text-sm"></i>
                </button>
            </div>
        </div>
        <div id="checkout-scrollable" class="flex-1 overflow-y-auto hide-scroll p-5 space-y-5 pb-32">
            <div id="order-id-banner" class="hidden"></div>
            <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
                <h3 class="text-sm font-bold text-gray-400 mb-3 flex items-center gap-2"><i class="fas fa-utensils"></i>
                    ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h3>
                <div id="cart-list-container" class="space-y-4"></div>
            </div>
            <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
                <h3 class="text-sm font-bold text-gray-400 mb-3 flex items-center gap-2"><i class="fas fa-user"></i>
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á</h3>
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><i
                            class="fas fa-pen text-[#B58D67]"></i></div>
                    <input type="text" id="user-name" maxlength="20" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô / Note ‡∏ñ‡∏∂‡∏á‡∏£‡πâ‡∏≤‡∏ô..."
                        class="block w-full pl-10 pr-3 py-3 border-2 border-[#E7E5E0] rounded-xl leading-5 bg-[#FAFAF9] placeholder-gray-400 focus:outline-none focus:bg-white focus:border-[#B58D67] focus:ring-0 transition-colors sm:text-sm font-bold text-[#3F3733]">

                </div>
            </div>
            <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
                <h3 class="text-sm font-bold text-gray-400 mb-3 flex items-center gap-2"><i class="fas fa-tags"></i>
                    ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á & ‡∏û‡∏≠‡∏¢‡∏ï‡πå</h3>
                <div class="flex gap-2 mb-3">
                    <div id="code-input-container"
                        class="flex-1 bg-gray-50 rounded-xl px-3 py-2 flex items-center gap-2 border border-gray-100">
                        <i class="fas fa-ticket-alt text-gray-400" id="code-icon"></i>
                        <input type="text" id="discount-code" placeholder="‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡πâ‡∏î‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤"
                            class="bg-transparent w-full text-sm outline-none text-gray-800 placeholder:text-gray-400 uppercase font-bold">
                    </div>
                    <button onclick="applyDiscount()" id="btn-apply-code"
                        class="btn-bounce bg-gray-800 text-white font-bold px-4 rounded-xl text-xs shadow-lg hover:bg-gray-700 transition-all">‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡πâ‡∏î</button>
                </div>
                <p id="discount-msg" class="text-[10px] font-medium text-gray-500 pl-1 mb-3 min-h-[1.25rem]"></p>
                <div
                    class="bg-gradient-to-br from-yellow-50 to-orange-50 rounded-xl p-3 border border-yellow-100 relative overflow-hidden">
                    <div class="flex justify-between items-center mb-2 relative z-10">
                        <div class="flex items-center gap-2">
                            <div
                                class="w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center text-white shadow-sm font-bold text-xs">
                                <i class="fas fa-star"></i>
                            </div>
                            <div>
                                <div class="text-[10px] text-yellow-700 font-bold uppercase tracking-wider">Kaprao
                                    Points</div>
                                <div class="text-xs font-bold text-gray-800" id="user-points-balance">‡∏°‡∏µ <span
                                        id="available-points">0</span> ‡πÅ‡∏ï‡πâ‡∏°</div>
                            </div>
                        </div>
                        <button id="points-toggle-btn" onclick="togglePointsUsage()"
                            class="text-[10px] bg-white text-yellow-600 border border-yellow-200 px-3 py-1.5 rounded-lg font-bold shadow-sm active:scale-95 transition-transform">‡πÅ‡∏•‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
                    </div>
                    <div id="points-controls-container"
                        class="hidden pt-2 border-t border-yellow-200/50 mt-2 relative z-10 animate-fade-in-down">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-[10px] text-yellow-700">‡πÉ‡∏ä‡πâ: <span id="points-used-display"
                                    class="font-bold text-indigo-600">0</span> ‡∏û‡∏≠‡∏¢‡∏ï‡πå</span>
                            <span class="text-xs font-bold text-red-500">‡∏•‡∏î <span id="points-discount-display">0</span>
                                ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="points-range-container mb-2">
                            <input type="range" id="points-range" min="0" max="100" value="0" step="10"
                                class="points-range w-full h-1.5 bg-yellow-200 rounded-lg appearance-none cursor-pointer accent-yellow-500">
                            <div class="flex justify-between text-[9px] text-yellow-600 mt-1"><span>0</span><span
                                    id="points-max">100</span></div>
                        </div>
                        <div class="flex gap-2">
                            <input type="hidden" id="points-input" value="0">
                            <div class="flex-1 text-[9px] text-yellow-600 flex items-center justify-end">*100 ‡πÅ‡∏ï‡πâ‡∏° =
                                10
                                ‡∏ö‡∏≤‡∏ó</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
                <h3 class="text-sm font-bold text-gray-400 mb-3">‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞</h3>
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between text-gray-500"><span>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (Subtotal)</span><span
                            id="summary-subtotal" class="font-medium">0.-</span></div>
                    <div id="discount-summary" class="flex justify-between text-green-500 hidden"><span><i
                                class="fas fa-ticket-alt mr-1"></i> ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡πÇ‡∏Ñ‡πâ‡∏î</span><span class="font-bold">-0.-</span>
                    </div>
                    <div id="points-summary" class="flex justify-between text-yellow-500 hidden"><span><i
                                class="fas fa-coins mr-1"></i> ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏≠‡∏¢‡∏ï‡πå</span><span class="font-bold">-0.-</span>
                    </div>
                    <div class="border-t border-gray-100 my-2 pt-2 flex justify-between items-end"><span
                            class="font-bold text-gray-800 text-lg">‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</span><span id="summary-grand-total"
                            class="font-black text-2xl text-indigo-600 leading-none">0.-</span></div>
                </div>
            </div>
            <div class="h-10"></div>
        </div>
        <div
            class="absolute bottom-0 left-0 right-0 p-5 bg-white border-t border-gray-100 shadow-[0_-10px_30px_rgba(0,0,0,0.05)] safe-area-pb-plus z-30">
            <button onclick="selectPaymentMethod()" id="btn-submit-order"
                class="btn-bounce w-full bg-gradient-to-r from-gray-900 to-gray-800 text-white font-bold text-lg py-4 rounded-2xl shadow-xl shadow-gray-300 flex justify-between items-center px-6 group hover:shadow-2xl transition-all">
                <span class="flex items-center gap-2 text-sm font-medium opacity-80"><i
                        class="fab fa-line text-green-400 text-lg"></i> ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</span>
                <div class="flex items-center gap-2 group-active:scale-95 transition-transform">
                    <span>‡∏™‡πà‡∏á‡πÄ‡∏•‡∏¢</span><i
                        class="fas fa-arrow-right bg-white/20 rounded-full w-6 h-6 flex items-center justify-center text-xs"></i>
                </div>
            </button>
        </div>
    </div>

    <!-- Order Tracking Sheet (New) -->
    <div id="order-tracking-overlay"
        class="fixed inset-0 bg-black/40 backdrop-blur-sm z-[140] hidden transition-opacity opacity-0"
        onclick="closeOrderTrackingSheet()"></div>
    <div id="order-tracking-sheet"
        class="fixed bottom-0 w-full h-[85vh] flex flex-col max-w-md mx-auto z-[141] transform translate-y-full transition-transform duration-300 bg-white rounded-t-[2rem] overflow-hidden shadow-2xl safe-area-pb">
        <!-- Header -->
        <div class="flex-none pt-4 pb-2 px-6 bg-white border-b border-gray-100 relative z-20">
            <div class="w-12 h-1.5 bg-gray-200 rounded-full mx-auto mb-4"></div>
            <div class="flex justify-between items-center mb-2">
                <div>
                    <h2 class="text-2xl font-black text-gray-800 flex items-center gap-2">üìã ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h2>
                    <p class="text-xs text-gray-400 font-medium">‡∏™‡∏±‡πà‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‡∏™‡πà‡∏á‡∏ß‡∏±‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ</p>
                </div>
                <button onclick="closeOrderTrackingSheet()"
                    class="btn-bounce w-10 h-10 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center hover:bg-gray-200"><i
                        class="fas fa-times"></i></button>
            </div>
        </div>
        <!-- Content -->
        <div id="order-tracking-content" class="flex-1 overflow-y-auto hide-scroll p-5 bg-gray-50/50 pb-24">
            <!-- Dynamic Content Routed by JS -->
        </div>
    </div>

    <!-- Points History Modal -->
    <!-- Tickets Sheet -->


    <!-- Active Orders Modal -->
    <div id="active-orders-modal"
        class="fixed inset-0 z-[150] bg-black/50 backdrop-blur-sm flex items-center justify-center p-6 hidden transition-opacity opacity-0">
        <div
            class="bg-white rounded-[2rem] p-1 w-full max-w-sm shadow-2xl relative overflow-hidden border border-gray-200">
            <div class="bg-white/95 backdrop-blur-sm rounded-[1.8rem] p-6 relative z-10">
                <div class="text-center mb-6">
                    <div
                        class="w-16 h-16 bg-gradient-to-br from-yellow-50 to-orange-50 rounded-full flex items-center justify-center mx-auto mb-4 text-2xl shadow-sm border-4 border-white animate-pulse">
                        üõµ
                    </div>
                    <h2 class="text-xl font-black text-gray-800 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h2>
                    <p class="text-yellow-600 font-bold text-xs">ORDER TRACKING</p>
                </div>

                <div id="active-orders-list" class="max-h-[50vh] overflow-y-auto mb-4 space-y-3 hide-scroll p-1">
                    <!-- Dynamic Orders -->
                </div>

                <button onclick="closeActiveOrdersList()"
                    class="btn-bounce w-full bg-gray-100 hover:bg-gray-200 text-gray-600 font-bold py-3 rounded-xl transition-all">‡∏õ‡∏¥‡∏î</button>
            </div>
        </div>
    </div>

    <!-- Points History -->
    <div id="points-history-modal"
        class="fixed inset-0 z-[130] bg-black/30 backdrop-blur-sm flex items-center justify-center p-6 hidden">
        <div
            class="bg-white rounded-[2rem] p-1 w-full max-w-sm shadow-2xl relative overflow-hidden border border-gray-200">
            <div class="bg-white/95 backdrop-blur-sm rounded-[1.8rem] p-6 text-center relative z-10">
                <div
                    class="w-20 h-20 bg-gradient-to-br from-yellow-50 to-orange-50 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl shadow-sm border-4 border-white">
                    ü™ô</div>
                <h2 class="text-2xl font-black text-gray-800 mb-1">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏û‡∏≠‡∏¢‡∏ï‡πå</h2>
                <p class="text-indigo-500 font-bold text-sm mb-4">KAPRAO POINTS HISTORY</p>
                <div id="points-history-list" class="max-h-60 overflow-y-auto mb-4">
                    <div class="text-center text-gray-400 py-8"><i class="fas fa-history text-3xl mb-2 opacity-30"></i>
                        <p class="text-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏û‡∏≠‡∏¢‡∏ï‡πå</p>
                    </div>
                </div>
                <button onclick="closePointsHistory()"
                    class="btn-bounce w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-xl shadow-lg transition-all border-2 border-indigo-500">‡∏õ‡∏¥‡∏î</button>
            </div>
        </div>
    </div>




    <!-- Toast -->
    <div id="toast">
        <i id="toast-icon" class="fas fa-info-circle"></i>
        <span id="toast-msg">Notification</span>
    </div>

    <!-- Receipt Modal -->
    <div id="receipt-result-modal"
        class="fixed inset-0 z-[140] bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 hidden">
        <div class="bg-transparent w-full max-w-sm flex flex-col items-center">
            <div class="bg-white p-2 rounded-lg shadow-2xl mb-4 overflow-hidden">
                <img id="receipt-result-img" class="w-full h-auto rounded" src="" alt="Receipt">
            </div>
            <div class="flex flex-col gap-2 w-full px-4">
                <button onclick="downloadReceiptImage()"
                    class="btn-bounce bg-gradient-to-r from-yellow-400 to-orange-500 text-white w-full py-3 rounded-xl font-bold shadow-lg flex items-center justify-center gap-2 text-lg">
                    <i class="fas fa-save"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                </button>
                <p class="text-white/70 text-xs text-center mb-2">(‡∏´‡∏≤‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡πÅ‡∏Ñ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÅ‡∏ó‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üì∏)</p>
                <button onclick="document.getElementById('receipt-result-modal').classList.add('hidden')"
                    class="btn-bounce bg-white/20 hover:bg-white/30 text-white w-full py-3 rounded-xl font-bold border border-white/50 backdrop-blur-md">‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á</button>
            </div>
        </div>
    </div>

    <div id="receipt-capture">
        <div class="bg-white p-6 relative">
            <div class="text-center mb-6">
                <div
                    class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-3 shadow-sm relative overflow-hidden">
                    <img id="receipt-avatar-img" src="" class="w-full h-full object-cover" crossorigin="anonymous">
                </div>
                <h2 class="text-2xl font-black text-gray-800 tracking-wider">KAPRAO52</h2>
                <p class="text-[10px] text-gray-500 tracking-widest uppercase mt-1">Authentic Thai Street Food</p>
                <div class="mt-4 inline-block px-4 py-1 bg-gray-100 rounded-full border border-gray-200">
                    <p class="text-xs font-bold text-gray-600">RECEIPT / ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</p>
                </div>
            </div>
            <div class="border-t-2 border-dashed border-gray-300 my-4"></div>
            <div class="flex justify-between items-center mb-1"><span class="text-xs text-gray-500">Order
                    ID</span><span class="font-bold text-gray-800 tracking-wide receipt-id">KP-XX99</span></div>
            <div class="flex justify-between items-center mb-1"><span class="text-xs text-gray-500">Date</span><span
                    class="font-medium text-xs text-gray-500 receipt-date">01/01/2024 12:00</span></div>
            <div class="flex justify-between items-center mb-4"><span class="text-xs text-gray-500">Customer</span><span
                    class="font-bold text-sm text-gray-800 receipt-name">Customer</span></div>
            <div class="bg-gray-50 rounded-lg p-3 mb-4 space-y-2 receipt-items border border-gray-100"></div>
            <div class="space-y-1">
                <div class="flex justify-between text-xs text-gray-500"><span>Subtotal</span><span
                        class="receipt-subtotal">0.-</span></div>
                <div class="flex justify-between text-xs text-green-600"><span>Discount</span><span
                        class="receipt-discount">-0.-</span></div>
                <div class="flex justify-between items-end mt-2 pt-2 border-t border-gray-300">
                    <span class="font-bold text-gray-800">TOTAL</span>
                    <span class="font-black text-3xl text-indigo-600 receipt-total">0.-</span>
                </div>
            </div>
            <div class="mt-6 pt-4 border-t-2 border-dotted border-gray-300 text-center">
                <div class="flex justify-center gap-1 text-2xl text-yellow-400 mb-2"><i class="fas fa-star"></i><i
                        class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                        class="fas fa-star"></i></div>
                <p class="text-[10px] text-gray-400">THANK YOU FOR YOUR ORDER</p>
                <div class="mt-4 flex justify-center opacity-50"><img
                        src="https://upload.wikimedia.org/wikipedia/commons/d/d0/QR_code_for_mobile_English_Wikipedia.svg"
                        class="w-16 h-16 mix-blend-multiply"></div>
            </div>
            <div class="absolute bottom-0 left-0 right-0 h-4 bg-white"
                style="background: linear-gradient(45deg, transparent 33.333%, #F3F4F6 33.333%, #F3F4F6 66.667%, transparent 66.667%), linear-gradient(-45deg, transparent 33.333%, #F3F4F6 33.333%, #F3F4F6 66.667%, transparent 66.667%); background-size: 20px 40px; transform: translateY(10px);">
            </div>
        </div>
    </div>

    <!-- External JavaScript Modules (dependency order) -->
    <script src="js/config.js"></script>
    <script src="js/data/menu.js"></script>
    <script src="js/data/promotions.js"></script>
    <script src="js/data/translations.js"></script> <!-- New -->
    <script src="js/i18n.js"></script> <!-- New -->
    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/lottery.js"></script>
    <script src="js/canvas.js"></script>
    <script src="js/avatar.js"></script>
    <script src="js/points.js"></script>
    <script src="js/menu.js"></script>
    <script src="js/dynamicMenu.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/checkout.js"></script>
    <script src="js/orderTracking.js"></script>
    <script src="js/gamification.js"></script>
    <script src="js/effects.js"></script>
    <script src="js/liff.js"></script>
    <script src="js/migration.js"></script>
    <script src="js/app.js"></script>

    <!-- BOTTOM NAVIGATION BAR -->
    <nav class="bottom-nav hidden" id="bottom-nav">
        <div class="bottom-nav-container">
            <div class="bottom-nav-item active" data-page="home" onclick="navigateTo('home')">
                <i class="fas fa-home bottom-nav-icon"></i>
                <span class="bottom-nav-label">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</span>
            </div>

            <div class="bottom-nav-item" data-page="tracking" onclick="navigateTo('tracking')">
                <i class="fas fa-motorcycle bottom-nav-icon"></i>
                <span class="bottom-nav-badge hidden" id="nav-tracking-badge">0</span>
                <span class="bottom-nav-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</span>
            </div>

            <div class="bottom-nav-item" data-page="cart" onclick="navigateTo('cart')">
                <i class="fas fa-shopping-basket bottom-nav-icon"></i>
                <span class="bottom-nav-badge hidden" id="nav-cart-badge">0</span>
                <span class="bottom-nav-label">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</span>
            </div>

            <div class="bottom-nav-item" data-page="more" onclick="navigateTo('more')">
                <i class="fas fa-bars bottom-nav-icon"></i>
                <span class="bottom-nav-label">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</span>
            </div>
        </div>
    </nav>
</body>

</html>